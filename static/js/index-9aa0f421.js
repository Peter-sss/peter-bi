var E=(f,p,r)=>new Promise((q,o)=>{var u=c=>{try{i(r.next(c))}catch(m){o(m)}},x=c=>{try{i(r.throw(c))}catch(m){o(m)}},i=c=>c.done?q(c.value):Promise.resolve(c.value).then(u,x);i((r=r.apply(f,p)).next())});import{d as A,W as U,r as R,aI as $,J as Q,x as s,c as F,B as J,w as t,h as e,f as S,p as l,t as b,l as a,A as G,b6 as P,u as W,Y,co as K,cr as X,e as Z,cO as O,a4 as j,bf as ee}from"./index-aa7518de.js";import{i as te}from"./icon-49f969d0.js";import{S as T}from"./SettingItem-1a79e0b6.js";import{S as H}from"./SettingItemBox-f83f1980.js";import"./chartEditStore-dcae2239.js";/* empty css                                                                      */import{R as ae,a as oe}from"./pondIndex.vue_vue_type_style_index_0_scoped_75801bda_lang-6f7f2db3.js";import{u as ne}from"./useTargetData.hook-30f23be8.js";import"./index-2a90f4b0.js";import"./EditorWorker-d94027f7.js";import"./editorWorker-43a98755.js";import{c as se}from"./http-52934de2.js";import{C as le}from"./index-ece80ce6.js";import"./plugin-2ac2d336.js";import"./index-b3402de5.js";import"./fileTypeEnum-21359a08.js";const re={class:"go-pr-3"},ce=l("—— "),de=l("取消"),ue=A({__name:"index",props:{modelShow:Boolean,targetData:Object,saveBtnText:String||null},emits:["update:modelShow","sendHandle"],setup(f,{emit:p}){const r=f,{chartConfig:q}=U(r.targetData),{requestContentType:o}=U(r.targetData.request),u=R(!1),x={[$.DEFAULT]:"普通请求",[$.SQL]:"SQL 请求"};Q(()=>r.modelShow,_=>{u.value=_},{immediate:!0});const i=()=>{p("update:modelShow",!1)},c=()=>{p("update:modelShow",!1),p("sendHandle")},m=()=>{i()};return(_,h)=>{const g=s("n-space"),C=s("n-scrollbar"),v=s("n-text"),k=s("n-tag"),w=s("n-button"),B=s("n-card"),d=s("n-modal");return F(),J(d,{class:"go-chart-data-request",show:u.value,"onUpdate:show":h[0]||(h[0]=n=>u.value=n),"mask-closable":!1,closeOnEsc:!0,onEsc:m},{default:t(()=>[e(B,{bordered:!1,role:"dialog",size:"small","aria-modal":"true",style:{width:"1000px",height:"800px"}},{header:t(()=>[]),"header-extra":t(()=>[]),action:t(()=>[e(g,{justify:"space-between"},{default:t(()=>[S("div",null,[e(v,null,{default:t(()=>[l("「 "+b(a(q).categoryName)+" 」",1)]),_:1}),e(v,null,{default:t(()=>[ce]),_:1}),e(k,{type:"primary",bordered:!1,style:{"border-radius":"5px"}},{default:t(()=>[l(b(x[a(o)]),1)]),_:1})]),S("div",null,[e(w,{class:"go-mr-3",onClick:i},{default:t(()=>[de]),_:1}),e(w,{type:"primary",onClick:c},{default:t(()=>[l(b(f.saveBtnText||"保存 & 发送请求"),1)]),_:1})])]),_:1})]),default:t(()=>[e(C,{style:{"max-height":"718px"}},{default:t(()=>[S("div",re,[e(g,{vertical:""},{default:t(()=>{var n;return[e(a(ae)),e(a(oe),{"target-data-request":(n=f.targetData)==null?void 0:n.request},null,8,["target-data-request"])]}),_:1})])]),_:1})]),_:1})]),_:1},8,["show"])}}}),ie=G(ue,[["__scopeId","data-v-8e6af488"]]),_e={class:"go-chart-configurations-data-ajax"},pe={class:"go-absolute-center"},me=l("编辑配置"),fe=l(" 测试 "),he=l(" 默认赋值给 dataset 字段 "),ge=l(" 发送请求 "),ve=A({__name:"index",setup(f){P(d=>({"272613bc":a(B)}));const{HelpOutlineIcon:p,FlashIcon:r,PulseIcon:q}=te.ionicons5,{targetData:o,chartEditStore:u}=ne(),{requestOriginUrl:x,requestInterval:i,requestIntervalUnit:c}=U(u.getRequestGlobalConfig),m=W(),_=R(!1),h=R(!1),g=R(!1);let C=0,v;const k=()=>{h.value=!0},w=()=>E(this,null,function*(){var d;if((d=o.value)!=null&&d.request){_.value=!0;try{const n=yield se(j(o.value.request),j(u.getRequestGlobalConfig));if(_.value=!1,n){const{data:D}=n;if(!D&&!o.value.filter){window.$message.warning("您的数据不符合默认格式，请配置过滤器！"),g.value=!0;return}o.value.option.dataset=ee(D,n,o.value.filter),g.value=!0;return}window.$message.warning("没有拿到返回值，请检查接口！")}catch(n){console.error(n),_.value=!1,window.$message.warning("数据异常，请检查参数！")}}}),B=Y(()=>m.getAppTheme);return K(()=>{var n;const d=(n=o.value)==null?void 0:n.filter;v!==d&&C&&(v=d,w()),C++}),X(()=>{v=null}),(d,n)=>{const D=s("n-tag"),y=s("n-input"),I=s("n-icon"),z=s("n-button"),L=s("n-card"),N=s("n-tooltip"),V=s("go-skeleton");return F(),Z("div",_e,[e(L,{class:"n-card-shallow"},{default:t(()=>[e(a(H),{name:"请求配置"},{default:t(()=>[e(a(T),{name:"类型"},{default:t(()=>[e(D,{bordered:!1,type:"primary",style:{"border-radius":"5px"}},{default:t(()=>[l(b(a(o).request.requestContentType===a($).DEFAULT?"普通请求":"SQL请求"),1)]),_:1})]),_:1}),e(a(T),{name:"方式"},{default:t(()=>[e(y,{size:"small",placeholder:a(o).request.requestHttpType||"暂无",disabled:!0},null,8,["placeholder"])]),_:1}),e(a(T),{name:"组件间隔"},{default:t(()=>[e(y,{size:"small",placeholder:`${a(o).request.requestInterval||"暂无"}`,disabled:!0},{suffix:t(()=>[l(b(a(O)[a(o).request.requestIntervalUnit]),1)]),_:1},8,["placeholder"])]),_:1}),e(a(T),{name:"全局间隔（默认）"},{default:t(()=>[e(y,{size:"small",placeholder:`${a(i)||"暂无"} `,disabled:!0},{suffix:t(()=>[l(b(a(O)[a(c)]),1)]),_:1},8,["placeholder"])]),_:1})]),_:1}),e(a(H),{name:"源地址",alone:!0},{default:t(()=>[e(y,{size:"small",placeholder:a(x)||"暂无",disabled:!0},{prefix:t(()=>[e(I,{component:a(q)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),e(a(H),{name:"组件地址",alone:!0},{default:t(()=>[e(y,{size:"small",placeholder:a(o).request.requestUrl||"暂无",disabled:!0},{prefix:t(()=>[e(I,{component:a(r)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),S("div",{class:"edit-text",onClick:k},[S("div",pe,[e(z,{type:"primary",secondary:""},{default:t(()=>[me]),_:1})])])]),_:1}),e(a(H),{alone:!0},{name:t(()=>[fe,e(N,{trigger:"hover"},{trigger:t(()=>[e(I,{size:"21",depth:3},{default:t(()=>[e(a(p))]),_:1})]),default:t(()=>[he]),_:1})]),default:t(()=>[e(z,{type:"primary",ghost:"",onClick:w},{icon:t(()=>[e(I,null,{default:t(()=>[e(a(r))]),_:1})]),default:t(()=>[ge]),_:1})]),_:1}),e(a(le),{show:g.value&&!_.value,ajax:!0},null,8,["show"]),e(V,{load:_.value,repeat:3},null,8,["load"]),e(a(ie),{modelShow:h.value,"onUpdate:modelShow":n[0]||(n[0]=M=>h.value=M),targetData:a(o),onSendHandle:w},null,8,["modelShow","targetData"])])}}});const Ee=G(ve,[["__scopeId","data-v-688badbe"]]);export{Ee as default};
