var O=(t,o,l)=>new Promise((p,v)=>{var b=e=>{try{g(l.next(e))}catch(c){v(c)}},d=e=>{try{g(l.throw(e))}catch(c){v(c)}},g=e=>e.done?p(e.value):Promise.resolve(e.value).then(b,d);g((l=l.apply(t,o)).next())});import{d as U,l as V,I as C,Z as j,j as E,a as i,o as r,c as H,b as a,w as n,n as f,e as B,t as L,F as N,q,E as w,G as M,u as s,a6 as oe,a7 as K,h as T,L as se,N as le,J as ce,O as ie,a8 as re,a9 as de,aa as A,R as J,U as W,V as Z}from"./index-f1b62783.js";import{i as Q}from"./icon-14375a60.js";import{M as X}from"./index-4eb4a155.js";import{p as _e,d as ue,a as pe}from"./project.api-a6799795.js";import{g as me,D as ge}from"./plugin-a824adf1.js";const ve={key:0,class:"go-items-list-card"},he={class:"list-content"},fe={class:"list-content-top"},we={class:"go-flex-items-center list-footer",justify:"space-between"},be={class:"go-flex-items-center list-footer-ri"},ye=U({__name:"index",props:{cardData:Object},emits:["preview","delete","resize","edit","release"],setup(t,{emit:o}){var _;const l=t,{EllipsisHorizontalCircleSharpIcon:p,CopyIcon:v,TrashIcon:b,PencilIcon:d,DownloadIcon:g,BrowsersOutlineIcon:e,HammerIcon:c,SendIcon:y}=Q.ionicons5,h=V([{label:C("global.r_edit"),key:"edit",icon:j(c)},{lable:C("global.r_more"),key:"select",icon:j(p)}]),m=E([{label:C("global.r_preview"),key:"preview",icon:j(e)},{label:(_=l.cardData)!=null&&_.release?C("global.r_unpublish"):C("global.r_publish"),key:"release",icon:j(y)},{label:C("global.r_delete"),key:"delete",icon:j(b)}]),D=u=>{switch(u){case"preview":$();break;case"delete":k();break;case"release":P();break;case"edit":x();break}},$=()=>{o("preview",l.cardData)},k=()=>{o("delete",l.cardData)},x=()=>{o("edit",l.cardData)},P=()=>{o("release",l.cardData)},I=()=>{o("resize",l.cardData)};return(u,R)=>{const z=i("n-image"),F=i("n-text"),Y=i("n-badge"),G=i("n-button"),ee=i("n-dropdown"),te=i("n-tooltip"),ae=i("n-space"),ne=i("n-card");return t.cardData?(r(),H("div",ve,[a(ne,{hoverable:"",size:"small"},{action:n(()=>[f("div",we,[a(F,{class:"go-ellipsis-1"},{default:n(()=>[B(L(t.cardData.title||t.cardData.id||"未命名"),1)]),_:1}),f("div",be,[a(ae,null,{default:n(()=>[a(F,null,{default:n(()=>[a(Y,{class:"go-animation-twinkle",dot:"",color:t.cardData.release?"#34c749":"#fcbc40"},null,8,["color"]),B(" "+L(t.cardData.release?u.$t("project.release"):u.$t("project.unreleased")),1)]),_:1}),(r(!0),H(N,null,q(h,S=>(r(),H(N,{key:S.key},[S.key==="select"?(r(),w(ee,{key:0,trigger:"hover",placement:"bottom",options:m.value,"show-arrow":!0,onSelect:D},{default:n(()=>[a(G,{size:"small"},{icon:n(()=>[(r(),w(M(S.icon)))]),_:2},1024)]),_:2},1032,["options"])):(r(),w(te,{key:1,placement:"bottom",trigger:"hover"},{trigger:n(()=>[a(G,{size:"small",onClick:Le=>D(S.key)},{icon:n(()=>[(r(),w(M(S.icon)))]),_:2},1032,["onClick"])]),default:n(()=>[(r(),w(M(S.label)))]),_:2},1024))],64))),128))]),_:1})])])]),default:n(()=>[f("div",he,[f("div",fe,[a(s(X),{class:"top-btn",hidden:["remove"],onClose:k,onResize:I})]),f("div",{class:"list-content-img",onClick:I},[a(z,{"object-fit":"contain",height:"180","preview-disabled":"",src:`${t.cardData.image}?time=${new Date().getTime()}`,alt:t.cardData.title,"fallback-src":s(oe)()},null,8,["src","alt","fallback-src"])])])]),_:1})])):K("",!0)}}});const De=T(ye,[["__scopeId","data-v-0814e2b8"]]),ke={class:"list-content"},xe={class:"list-content-img"},Ce=["src","alt"],He=U({__name:"index",props:{modalShow:{required:!0,type:Boolean},cardData:{required:!0,type:Object}},emits:["close","edit"],setup(t,{emit:o}){const l=t,{HammerIcon:p}=Q.ionicons5,v=E(!1);se(()=>l.modalShow,c=>{v.value=c},{immediate:!0});const b=V([{label:C("global.r_edit"),key:"edit",icon:j(p)}]),d=c=>{switch(c){case"edit":g();break}},g=()=>{o("edit",l.cardData)},e=()=>{o("close")};return(c,y)=>{const h=i("n-text"),m=i("n-space"),D=i("n-time"),$=i("n-badge"),k=i("n-button"),x=i("n-tooltip"),P=i("n-card"),I=i("n-modal");return r(),w(I,{class:"go-modal-box",show:v.value,"onUpdate:show":y[0]||(y[0]=_=>v.value=_),"mask-closable":!0,onAfterLeave:e},{default:n(()=>[a(P,{hoverable:"",size:"small"},{action:n(()=>[a(m,{class:"list-footer",justify:"space-between"},{default:n(()=>[a(h,{depth:"3"},{default:n(()=>[B(L(c.$t("project.last_edit"))+": ",1),a(D,{time:new Date,format:"yyyy-MM-dd hh:mm"},null,8,["time"])]),_:1}),a(m,null,{default:n(()=>[a(h,null,{default:n(()=>{var _,u;return[a($,{class:"go-animation-twinkle",dot:"",color:(_=t.cardData)!=null&&_.release?"#34c749":"#fcbc40"},null,8,["color"]),B(" "+L((u=t.cardData)!=null&&u.release?c.$t("project.release"):c.$t("project.unreleased")),1)]}),_:1}),(r(!0),H(N,null,q(b,_=>(r(),w(x,{key:_.key,placement:"bottom",trigger:"hover"},{trigger:n(()=>[a(k,{size:"small",onClick:u=>d(_.key)},{icon:n(()=>[(r(),w(M(_.icon)))]),_:2},1032,["onClick"])]),default:n(()=>[(r(),w(M(_.label)))]),_:2},1024))),128))]),_:1})]),_:1})]),default:n(()=>{var _,u;return[f("div",ke,[a(m,{class:"list-content-top go-px-0",justify:"center"},{default:n(()=>[a(m,null,{default:n(()=>[a(h,null,{default:n(()=>{var R,z;return[B(L(((R=t.cardData)==null?void 0:R.title)||((z=t.cardData)==null?void 0:z.id)||"未命名"),1)]}),_:1})]),_:1})]),_:1}),a(m,{class:"list-content-top"},{default:n(()=>[a(s(X),{narrow:!0,hidden:["close"],onRemove:e})]),_:1}),f("div",xe,[f("img",{src:(_=t.cardData)==null?void 0:_.image,alt:(u=t.cardData)==null?void 0:u.title},null,8,Ce)])])]}),_:1})]),_:1},8,["show"])}}});const $e=T(He,[["__scopeId","data-v-c853dce2"]]),Ie=()=>{const t=E(!1),o=E(null);return{modalData:o,modalShow:t,closeModal:()=>{t.value=!1,o.value=null},resizeHandle:d=>{d&&(t.value=!0,o.value=d)},editHandle:d=>{if(!d)return;const g=le(ce.CHART_HOME_NAME,"href");ie(g,[d.id],void 0,!0)},previewHandle:d=>{re(de(d.id))}}},ze=()=>{const t=E(!0),o=V({page:1,limit:12,count:10}),l=E([]),p=()=>O(void 0,null,function*(){t.value=!0;const e=yield _e({page:o.page,limit:o.limit});if(e&&e.data){const{count:c}=e;o.count=c,l.value=e.data.map(y=>{const{id:h,projectName:m,state:D,createTime:$,indexImage:k,createUserId:x}=y;return{id:h,title:m,createId:x,time:$,image:k,release:D!==-1}}),setTimeout(()=>{t.value=!1},500);return}A()}),v=e=>{o.page=e,p()},b=e=>{o.limit=e,p()},d=e=>{me({type:ge.DELETE,promise:!0,onPositiveCallback:()=>new Promise(c=>{c(ue({ids:e.id}))}),promiseResCallback:c=>{if(c.code===J.SUCCESS){window.$message.success(window.$t("global.r_delete_success")),p();return}A()}})},g=(e,c)=>O(void 0,null,function*(){const{id:y,release:h}=e,m=yield pe({id:y,state:h?-1:1});if(m&&m.code===J.SUCCESS){if(l.value=[],p(),h){window.$message.success(window.$t("global.r_unpublish_success"));return}window.$message.success(window.$t("global.r_publish_success"));return}A()});return p(),{loading:t,paginat:o,list:l,fetchList:p,releaseHandle:g,changeSize:b,changePage:v,deleteHandle:d}},Se={class:"go-items-list"},je={class:"list-pagination"},Ee=U({__name:"index",setup(t){const{modalData:o,modalShow:l,closeModal:p,previewHandle:v,resizeHandle:b,editHandle:d}=Ie(),{loading:g,paginat:e,list:c,changeSize:y,changePage:h,releaseHandle:m,deleteHandle:D}=ze();return($,k)=>{const x=i("go-loading"),P=i("n-grid-item"),I=i("n-grid"),_=i("n-pagination");return r(),H(N,null,[f("div",Se,[W(f("div",null,[a(x)],512),[[Z,s(g)]]),W(f("div",null,[a(I,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:4 xl:4 xxl:4",responsive:"screen"},{default:n(()=>[(r(!0),H(N,null,q(s(c),(u,R)=>(r(),w(P,{key:u.id},{default:n(()=>[a(s(De),{cardData:u,onPreview:s(v),onResize:s(b),onDelete:z=>s(D)(u),onRelease:z=>s(m)(u,R),onEdit:s(d)},null,8,["cardData","onPreview","onResize","onDelete","onRelease","onEdit"])]),_:2},1024))),128))]),_:1})],512),[[Z,!s(g)]]),f("div",je,[a(_,{page:s(e).page,"page-size":s(e).limit,"item-count":s(e).count,"page-sizes":[12,24,36,48],"onUpdate:page":s(h),"onUpdate:pageSize":s(y),"show-size-picker":""},null,8,["page","page-size","item-count","onUpdate:page","onUpdate:pageSize"])])]),s(o)?(r(),w(s($e),{key:0,modalShow:s(l),cardData:s(o),onClose:s(p),onEdit:s(d)},null,8,["modalShow","cardData","onClose","onEdit"])):K("",!0)],64)}}});const Pe=T(Ee,[["__scopeId","data-v-c7933e27"]]),Re={class:"go-project-items"},Be=U({__name:"index",setup(t){return(o,l)=>(r(),H("div",Re,[a(s(Pe))]))}});const Ve=T(Be,[["__scopeId","data-v-ba0e1d55"]]);export{Ve as default};
